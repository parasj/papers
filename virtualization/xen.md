## Xen and the Art of Virtualization

Xen is a classic paper with a lot of impact. It proposes a practical design for a paravirtualized VMM. They argue that the technique in VMWare ESX leads to large complexity and a performance penalty (due to dynamic rewriting). Instead, Xen modifies the OS in small ways to interact with primitives provided by the Xen VMM.

Xen presents 3 classes of resources that need to have interfaces: Memory, CPU, and IO. Memory should support segmentation (in safe manner) and paging. The CPU should support lightweight interfaces to interrupts and syscalls while still supporting standard interrupts. Time should also be properly handled. Finally, IO is supported using asynchonous IO rings. Of all concerns, memory is the most difficult provision to guarantee safe and performant isolation. This is due to an "uncooperative x86" which does not support software virtualization of the MMU + TLB. x86 forces a TLB flush on address space switch. Xen lives in a fixed portion of address space so that no TLB flush is needed when it runs. Moreover, the guest OS manages it's own PT on hardware for performance. CPU is then virtualized using timeslicing.

The authors demonstrate that paravirutalization incurs minimal cost of changes - <2% LOC. this is better than other work in the paravirtualization space. I like this paper a lot, but my main criticism for the paper is that I think the paper should have instructed computer architects on how they can modify future designs to better support virtualization. Intel ended up implementing multi-level page-table mechanisms for performance, but I think the authors could have proposed better mechanisms and have discussed the implications of those architectural changes on their system.
